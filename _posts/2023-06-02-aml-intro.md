---
layout: distill
title: Tutorial on Adversarial Machine Learning - Part 1
description: The Good, The Bad, The Ugly, The Efforts, and The Difficulties
tags: aml
giscus_comments: true
date: 2023-06-02
featured: false

authors:
  - name: Tuan-Anh Bui
    url: "https://tuananhbui89.github.io/"
    affiliations:
      name: Monash University

bibliography: 2023-06-02-distill.bib

# Optionally, you can add a table of contents to your post.
# NOTES:
#   - make sure that TOC names match the actual section names
#     for hyperlinks within the post to work correctly.
#   - we may want to automate TOC generation in the future using
#     jekyll-toc plugin (https://github.com/toshimaru/jekyll-toc).
toc:
  - name: The Good
    # if a section has subsections, you can add them as follows:
    # subsections:
    #   - name: Example Child Subsection 1
    #   - name: Example Child Subsection 2
  - name: The Bad
  - name: The Ugly
  - name: The Efforts
  - name: The Difficulties

# Below is an example of injecting additional post-specific styles.
# If you use this post as a template, delete this _styles block.
_styles: >
  .fake-img {
    background: #bbb;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 12px;
  }
  .fake-img p {
    font-family: monospace;
    color: white;
    text-align: left;
    margin: 12px 0;
    text-align: center;
    font-size: 16px;
  }

---

## The Good - The Age of Deep Neural Networks

Deep Neural Networks (DNNs) have revolutionized various domains, showcasing remarkable achievements in computer vision <d-cite key="he2016deep"></d-cite>, natural language processing <d-cite key="vaswani2017attention"></d-cite>, and speech processing <d-cite key="amodei2016deep"></d-cite>. These powerful models have surpassed human-level accuracy in tasks like image classification and language processing, propelling them into real-world applications. 
Nowadays, DNNs are ubiquitous, powering the technology we use every day, from voice assistants like Siri to self-driving Tesla cars.
Their impact is undeniable, transforming the way we interact with technology and reshaping industries across the globe.

## The Bad - Current DNNs are not reliable and secure

While DNNs have achieved unprecedented success and widespread adoption, their reliability and security remain a concern. 
DNNs are known as black-box models, meaning that their internal workings are not transparent to users, and even their creators.
This lack of transparency makes it difficult to understand their behavior and trust their decisions.

For some low-stakes applications, such as fraud transactions detection or movie recommendation, it is not a big deal if the model makes a mistake. The consequences of incorrect predictions are not severe. However, for some high-stakes applications, such as autonomous driving, clinical diagnostics, auto-trading bots where the model's decisions can lead to life-threatening conditions or economic collapse, it is crucial to understand the model's behavior and trust its decisions. Just think about a situation, when you have a serious disease and a machine learning model predicts that you should take a specific medicine, would you trust the model's decision to take the medicine? 

| AI's application        | AI's risk                             | Consequence                 |
|-------------------------|---------------------------------------|-----------------------------|
|  Commercial Ads recommendation      | Matching "users-interest" incorrectly | Seeing non-interested Ads   |
| Auto-trading bot        | Triggering wrong signal               | Financial loss              |
| Autopilot in Tesla      | Mist-Classifying "Stop-Sign"          | Fatal crash                 |
| Autonomous drone swarms | Wrong targeting/attacking             | Fatal mistake - many deaths |

**Some examples of catastrophic failures of unreliable DNNs in real-life:**

- [Tesla behind eight-vehicle crash was in ‘full self-driving’ mode](https://www.theguardian.com/technology/2022/dec/22/tesla-crash-full-self-driving-mode-san-francisco)
- [IBM’s Watson supercomputer recommended ‘unsafe and incorrect’ cancer treatments](https://www.statnews.com/2018/07/25/ibm-watson-recommended-unsafe-incorrect-treatments/)
- [A fake AI photo of a Pentagon blast wiped billions off Wall Street](https://www.smh.com.au/business/markets/how-a-fake-ai-photo-of-a-pentagon-blast-wiped-billions-off-wall-street-20230524-p5daqo.html)

**Conclusion: The more autonomous the AI system is, the more important it is to understand the model's behavior and trust its decisions.**

## The Ugly - Adversarial examples on DNNs

In addition to their lack of transparency, DNNs are also vulnerable to adversarial attacks including backdoor attacks, poisoning attacks, and adversarial examples. 
A notable work from Szegedy et al. (2014) <d-cite key="szegedy2013intriguing"></d-cite> was the first work demonstrated that DNNs are susceptible to adversarial examples, subtle modifications to input data that can manipulate their behavior. 
And the worst part is that generating adversarial examples is easy and fast <d-cite key="madry2017towards"></d-cite>.

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="https://raw.githubusercontent.com/tuananhbui89/website_images/master/posts/aml_intro/adversarial_1_10.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Adversarial examples <a href="https://github.com/tuananhbui89/demo_attack">(link to the demo)</a>.
</div>

The above example illustrates an adversarial example generated from a pre-trained ResNet50 model. The image on the left is the original image of a koala, which is correctly classified as a koala with nearly 50% confidence. The image in the middle is the adversarial perturbation, which is imperceptible to the human eye. The image on the right is the adversarial example generated from the original image on the left. The adversarial example is misclassified as a ballon with nearly 100% confidence.

## Efforts to Tackle Adversarial Examples

Since the discovery of adversarial examples [4], it has been an extensive with the number of papers on this topic increasing exponentially, as shown in the figure below. 

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="https://raw.githubusercontent.com/tuananhbui89/website_images/master/posts/aml_intro/papers_per_year_side_by_side.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Number of adversarial examples papers published on arXiv from 2014 to May 2023. Data source from Carlini's post <a href="https://nicholas.carlini.com/writing/2019/all-adversarial-example-papers.html">(link)</a>.
</div>

On the one hand, various attack methods have been proposed to enhance effectiveness <d-cite key="madry2017towards"></d-cite> , computational efficiency <d-cite key="zhang2022revisiting"></d-cite> , transferability among inputs <d-cite key="moosavi2017universal"></d-cite>  or among models <d-cite key="papernot2016transferability"></d-cite> . 

On the other hand, there is also an extremely large number of defense methods proposed to mitigate adversarial attacks, from all aspects of the machine learning pipeline.  

- Architecture-based defenses: Ensemble models <d-cite key="tramer2017ensemble"></d-cite> , distillation <d-cite key="papernot2016distillation"></d-cite> , quantization <d-cite key="gui2019model"></d-cite> , model pruning <d-cite key="dhillon2018stochastic"></d-cite> , smooth activation functions <d-cite key="xie2020smooth"></d-cite> , etc. 
- Preprocessing-based defenses: transformations to remove adversarial perturbations such as JPEG compression <d-cite key="dziugaite2016study"></d-cite> , etc.
- Postprocessing-based defenses: detecting adversarial examples <d-cite key="metzen2017detecting"></d-cite> , etc. 
- Training-based defenses: adversarial training <d-cite key="madry2017towards"></d-cite>, regularization <d-cite key="bui2020improving"></d-cite> , etc. 

Despite numerous defense strategies being proposed to counter adversarial attacks, no method has yet provided comprehensive protection or completely illuminated the vulnerabilities of DNNs.

## The Difficulties of Evaluating Adversarial Robustness

Checking out the toughness of adversarial examples is a lot trickier than your usual machine learning model checks. This is mainly because adversarial examples don't just pop up naturally, you have to create them using adversaries. And let's just say, making these examples to honestly reflect the threat model takes a lot of genuine efforts.

Now, there's this thing called gradient masking that folks often use to stop gradient information from being used to make adversarial examples. Attacks like PGD, for instance, need to work out the gradients of the model's loss function to create adversarial examples. But sometimes, due to the way the model is built or trained, you might not be able to get the precise gradients you need, and this can throw a wrench in the works of adversarial attacks.

Also, adversarial attacks can be quite picky when it comes to specific settings. Like, a PGD attack might work great when you use a certain step size, number of iterations, and scale of logits, but not so well in other settings. Transferred attacks, on the other hand, care a lot about the model you choose as a substitute. So, you've got to make sure you're checking the toughness of adversarial examples in lots of different settings.

Carlini et al. (2019) <d-cite key="carlini2019evaluating"></d-cite>  came up with a really handy checklist in 2019. It points out common slip-ups people make when they're checking out adversarial robustness and offers some tips to dodge these pitfalls.
