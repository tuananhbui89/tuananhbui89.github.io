<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Fantastic Targets for Concept Erasure in Diffusion Models and Where to Find Them | Tuan-Anh  Bui</title>
    <meta name="author" content="Tuan-Anh  Bui">
    <meta name="description" content="Researcher in Generative AI and Trustworthy AI
">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Bootstrap Table -->
    <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e">
    <link rel="canonical" href="https://tuananhbui89.github.io/projects/fantastic-concepts/">

    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">
    <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script>
    <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Tuan-Anh¬†</span>Bui</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/repositories/">repositories</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/teaching/"></a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      
        <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">Fantastic Targets for Concept Erasure in Diffusion Models and Where to Find Them</h1>
            <p class="post-description"></p>
          </header>

          <article>
            <div style="text-align: center;">
Tuan-Anh Bui<sup>1</sup>, Thuy-Trang Vu<sup>1</sup>, Long Vuong<sup>1</sup>, Trung Le<sup>1</sup>, Paul Montague<sup>2</sup>, Tamas Abraham<sup>2</sup>, Junae Kim<sup>2</sup>, Dinh Phung

<sup>1</sup> Monash University, Australia;
<sup>2</sup> Defence Science and Technology Group, Australia

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <a href="https://github.com/tuananhbui89/Adaptive-Guided-Erasure" class="btn btn-primary" target="_blank" rel="external nofollow noopener">GitHub</a>
        <a href="https://arxiv.org/abs/2501.18950" class="btn btn-secondary" target="_blank" rel="external nofollow noopener">arXiv</a>
        <a href="https://www.dropbox.com/scl/fi/jmqtqp939jfr7p3xrel8x/2024-AP-compact.pdf?rlkey=bzkhlhmg63efijlzo51mpnwzf&amp;st=69no55kd&amp;dl=0" class="btn btn-orange" target="_blank" rel="external nofollow noopener">Slides</a>
        <a href="https://www.dropbox.com/scl/fi/kzo7x78ryjpxqyhgtfqdb/ICLR-2025-AGE.pdf?rlkey=thbtmr3tn603z5q1ze8tetchm&amp;st=8hgkjrnf&amp;dl=0" class="btn btn-success" target="_blank" rel="external nofollow noopener">Poster</a>
    </div>
</div>
</div>

<p><strong>(Shameless plug <img class="emoji" title=":grin:" alt=":grin:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f601.png" height="20" width="20">) Our other papers on Concept Erasing/Unlearning:</strong></p>

<blockquote>
  <p><a href="https://arxiv.org/abs/2501.18950" rel="external nofollow noopener" target="_blank"><strong>Fantastic Targets for Concept Erasure in Diffusion Models and Where to Find Them</strong></a>,     <br>
Tuan-Anh Bui, Thuy-Trang Vu, Long Vuong, Trung Le, Paul Montague, Tamas Abraham, Junae Kim, Dinh Phung     <br>
<em>ICLR 2025 (<a href="https://arxiv.org/abs/2501.18950" rel="external nofollow noopener" target="_blank">arXiv 2501.18950</a>)</em></p>
</blockquote>

<blockquote>
  <p><a href="https://arxiv.org/abs/2410.15618" rel="external nofollow noopener" target="_blank"><strong>Erasing Undesirable Concepts in Diffusion Models with Adversarial Preservation</strong></a>,     <br>
Tuan-Anh Bui, Long Vuong, Khanh Doan, Trung Le, Paul Montague, Tamas Abraham, Dinh Phung     <br>
<em>NeurIPS 2024 (<a href="https://arxiv.org/abs/2410.15618" rel="external nofollow noopener" target="_blank">arXiv 2410.15618</a>)</em></p>
</blockquote>

<blockquote>
  <p><a href="https://arxiv.org/abs/2403.12326" rel="external nofollow noopener" target="_blank"><strong>Hiding and Recovering Knowledge in Text-to-Image Diffusion Models via Learnable Prompts</strong></a>,     <br>
Tuan-Anh Bui, Khanh Doan, Trung Le, Paul Montague, Tamas Abraham, Dinh Phung     <br>
<em>Preprint (<a href="https://arxiv.org/abs/2403.12326" rel="external nofollow noopener" target="_blank">arXiv 2403.12326</a>)</em></p>
</blockquote>

<h2 id="abstract">Abstract</h2>

<p>Concept erasure has emerged as a promising technique for mitigating the risk of harmful content generation in diffusion models by selectively unlearning undesirable concepts. 
The common principle of previous works to remove a specific concept is to map it to a fixed generic concept, such as a neutral concept or just an empty text prompt. 
In this paper, we demonstrate that this fixed-target strategy is suboptimal, as it fails to account for the impact of erasing one concept on the others. 
To address this limitation, we model the concept space as a graph and empirically analyze the effects of erasing one concept on the remaining concepts. 
Our analysis uncovers intriguing geometric properties of the concept space, where the influence of erasing a concept is confined to a local region. 
Building on this insight, we propose the Adaptive Guided Erasure (AGE) method, which <strong>dynamically</strong> selects optimal target concepts tailored to each undesirable concept, minimizing unintended side effects. 
Experimental results show that AGE significantly outperforms state-of-the-art erasure methods on preserving unrelated concepts while maintaining effective erasure performance.</p>

<div class="row mt-3 text-center">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/fantastic_concepts/ICLR-2025-AGE-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/fantastic_concepts/ICLR-2025-AGE-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/fantastic_concepts/ICLR-2025-AGE-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/fantastic_concepts/ICLR-2025-AGE.jpg" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>

<h2 id="key-observations">Key Observations</h2>

<h3 id="geometric-properties-of-the-concept-graph">Geometric Properties of the Concept Graph</h3>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/fantastic_concepts/merge_two_stacked_target_empty_full_English_Springer_34_True_delta_top5-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/fantastic_concepts/merge_two_stacked_target_empty_full_English_Springer_34_True_delta_top5-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/fantastic_concepts/merge_two_stacked_target_empty_full_English_Springer_34_True_delta_top5-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/fantastic_concepts/merge_two_stacked_target_empty_full_English_Springer_34_True_delta_top5.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    Analysis of the impact of choosing empty concept as the target concept for erasure.
</div>

<ul>
  <li>
<strong>Locality:</strong> The concept graph is sparse and localized, which means that the impact of erasing one concept does not <strong>strongly</strong> spread to all the other concepts but only local concepts that are semantically related to the erased concept \(c_e\).</li>
  <li>
<strong>Asymmetry:</strong> The concept graph is asymmetric such that the impact of erasing concept \(c_e\) on concept \(c_j\) is not the same as the impact of erasing concept \(c_j\) on concept \(c_e\).</li>
  <li>
<strong>Abnormal:</strong> The two abnormal concepts ‚ÄúBell Cote‚Äù and ‚ÄúOboe‚Äù, which have low generation capability to begin with, are sensitive to the erasure of any concept.</li>
</ul>

<h3 id="what-are-the-fantastic-concepts">What are the Fantastic Concepts?</h3>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/fantastic_concepts/merge_two_stacked_target_specific_English_Springer_35_True_delta_top5-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/fantastic_concepts/merge_two_stacked_target_specific_English_Springer_35_True_delta_top5-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/fantastic_concepts/merge_two_stacked_target_specific_English_Springer_35_True_delta_top5-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/fantastic_concepts/merge_two_stacked_target_specific_English_Springer_35_True_delta_top5.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    Analysis of the impact of choosing a specific concept as the target concept for erasure.
</div>

<ul>
  <li>
    <p><strong>Locality:</strong> Regardless of the choice of the target concept, the impact of erasing one concept is still sparse and localized.</p>
  </li>
  <li>
    <p><strong>Abnormal:</strong> The two abnormal concepts ‚ÄúBell Cote‚Äù and ‚ÄúOboe‚Äù are still sensitive to the erasure of any concept regardless of the choice of the target concept.</p>
  </li>
  <li>
    <p><strong>Synonym ‚ùå‚ùå‚ùå:</strong> Mapping to a synonym of the anchor concept leads to a minimal change as evidenced by the lowest \(\Delta(c_e, c_j)\) for all \(c_j\). However, it also the least effective in erasing the undesirable concept \(c_e\).</p>
  </li>
  <li>
    <p><strong>All Unrelated Concepts ‚ùå‚ùå:</strong> Mapping to semantically unrelated concepts demonstrates the similar performance as the generic concept ‚Äú ‚Äú, as evidenced by the similar \(\Delta(c_e, c_j)\) between the three last rows (\(5^{th}-7^{th}\)) in each subset.</p>
  </li>
  <li>
    <p><strong>General concepts ‚ùå:</strong> While choosing a general concept as the target concept is intuitive and reasonable, it does not necessary lead to good preservation performance. For example, ‚ÄúEnglish Springer‚Äù ‚Üí ‚ÄúDog‚Äù or ‚ÄúFrench Horn‚Äù ‚Üí ‚ÄúMusical Instrument Horn‚Äù still cause a drop on related concepts in their respective subsets.
Moreover, there are also small drops on erasing performance compared to other strategies, shown by DS-5 of 83%, 91%, and 78% when mapping ‚ÄúGarbage Truck‚Äù to ‚ÄúTruck‚Äù, ‚ÄúFrench Horn‚Äù to ‚ÄúMusical Instrument Horn‚Äù, and ‚ÄúCassette Player‚Äù to ‚ÄúAudio Device‚Äù, respectively.
The two observations indicate that choosing a general concept is not an optimal strategy.</p>
  </li>
  <li>
    <p><strong>In-class ‚úÖ:</strong> The highest preservation performance which is consistently observed in all five subsets is achieved when the target concept is a closely related concept to \(c_e\).
For example, ‚ÄúEnglish Springer‚Äù ‚Üí ‚ÄúClumber spaniel‚Äù or ‚ÄúGarbage Truck‚Äù ‚Üí ‚ÄúMoving Van‚Äù or ‚ÄúSchool Bus‚Äù in the ‚ÄúDog‚Äù and ‚ÄúVehicle‚Äù subsets.</p>
  </li>
</ul>

<h3 id="analogy-to-the-concept-graph">Analogy to the Concept Graph</h3>

<p>The concept space of a generative model can be represented as a graph like a spiderweb, where each node is a concept and edges are the impact of one concept on the others. When we remove a concept, it‚Äôs like dropping a ball into this conceptual spiderweb, triggering a chain reaction. The impact of erasure spreads out, strongly affecting locally related concepts while weakly affecting those further away or unrelated.</p>

<p>When we map a concept to a target concept, it‚Äôs like pull two nodes of the spiderweb closer together, therefore, the impact of erasure will be proportional to the distance between the two nodes, i.e., 
the further away between the two concepts, the more impact of erasure to the whole concept space.
The fantastic target concepts found in our paper are the ones that are locally connected to the concept to be erased but are not its synonyms, therefore, being the optimal target concepts for erasure that minimize the impact on the whole concept space.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/fantastic_concepts/2025-02-28-22-24-26-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/fantastic_concepts/2025-02-28-22-24-26-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/fantastic_concepts/2025-02-28-22-24-26-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/fantastic_concepts/2025-02-28-22-24-26.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    The concept graph. Image credit: <a href="https://www.researchgate.net/publication/275669825_On_the_universal_structure_of_human_lexical_semantics" rel="external nofollow noopener" target="_blank">On the universal structure of human lexical semantics</a>.
</div>

<h3 id="implications-of-the-concept-graph">Implications of the Concept Graph</h3>

<p>One of the most interesting contributions of this work is the introduction of the concept graph, which represents a generative model‚Äôs capability as a graph, where nodes are discrete visual concepts, and edges are the relationships between those concepts.</p>

<p>Understanding this graph structure is essential for many tasks, such as:</p>

<ul>
  <li>
<strong>Machine Unlearning</strong> üóëÔ∏è: The goal here is to remove the model‚Äôs knowledge of certain concepts while retaining its knowledge of others. The concept graph structure helps identify which concepts are critical to the model‚Äôs performance and should be preserved.</li>
  <li>
<strong>Personalization</strong> üë§: The goal is to personalize the model‚Äôs knowledge for a specific user. For instance, changing ‚Äúa photo of a <em>cat</em> before Vancouver Convention Center‚Äù to ‚Äúa photo of a <em>cat</em> before the user‚Äôs house.‚Äù Traditional methods like Dreambooth, which fine-tune the model on a small user-specific dataset, often overfit to the specific concept and degrade the model‚Äôs general capability. Prior approaches address this by collecting large datasets of <strong>heuristically selected concepts</strong>‚Äîe.g., if the personalized concept is ‚Äúa user‚Äôs house,‚Äù the preservation dataset would include a variety of house images. Our concept graph structure can help identify which concepts are specific to the user and should be preserved, improving the balance between personalization and generalization.</li>
</ul>

<h2 id="where-to-find-the-fantastic-concepts">Where to Find the Fantastic Concepts?</h2>

<p>Motivated by the above observations, we propose to select the target concept for erasure adaptively for each query concept to mitigate the side effects of erasing undesirable concepts in diffusion models.</p>

<p>More specifically, the ideal target concept should satisfy the following properties:</p>

<ul>
  <li>It should not be a synonym of the query concept that resembles a similar visual appearance (e.g., ‚Äúnudity‚Äù to ‚Äúnaked‚Äù or ‚Äúnude‚Äù, or ‚ÄúGarbage Truck‚Äù to ‚ÄúWaste Collection Vehicle‚Äù). This ensures that the erasure performance on the query concept remains effective.</li>
  <li>It should be closely related to the query concept but not identical (e.g., ‚ÄúEnglish Springer‚Äù to ‚ÄúClumber Spaniel‚Äù, or ‚ÄúGarbage Truck‚Äù to ‚ÄúMoving Van‚Äù). This helps preserve the model‚Äôs generation capabilities on other concepts. As suggested by the locality property of the concept graph, changes in the model‚Äôs output can be used to identify these locally related concepts.</li>
</ul>

<p>Although it is possible to manually select the ideal target concept for each query concept based on the above properties, this approach is not scalable for a large erasing set <strong>E</strong>. 
Therefore, we propose an optimization-based approach to automatically and adaptively find the optimal target concept for each query concept. Specifically, we aim to solve the following optimization problem:</p>

\[\underset{\theta^{'}}{\min} \; 
\underset{c_e \in \mathbf{E}}{\mathbb{E}} \; \underset{c_{t} \in \mathcal{C}}{\max} \left[ \underbrace{\left\|\epsilon_{\theta^{'}}(\tau(c_e)) - \epsilon_{\theta}(\tau(c_{t})) \right\|_2^2}_{L_1}  +  \lambda \underbrace{\left\|\epsilon_{\theta^{'}}(\tau(c_{t})) - \epsilon_{\theta}(\tau(c_{t}))\right\|_2^2}_{L_2} \right]\]

<p>where \(\lambda\) is a trade-off hyperparameter and \(\mathcal{C}\) is the search space of target concepts \(c_t\).</p>

<p><strong>Interpretation of the optimization problem:</strong></p>

<p><strong>Minimizing the objective \(L_1\)</strong> w.r.t. \(\theta^{'}\) ensures that the output of the sanitized model for the query concept \(c_e\) is close to the output of the original model but for the target concept \(c_t\), which serves the purpose of erasing the undesirable concept \(c_e\).</p>

<p>Meanwhile, <strong>minimizing the objective \(L_2\)</strong> w.r.t. \(\theta^{'}\) ensures that the output of the two models remain similar for the same input concept \(c_t\), preserving the model‚Äôs capability on the remaining concepts.</p>

<p>In summary, the <strong>outer minimization problem</strong> optimizes the sanitized model parameters \(\theta^{'}\) to simultaneously erase undesirable concepts and preserve the model‚Äôs functionality for other concepts.</p>

<p>On the other hand, <strong>maximizing the objective \(L_1\)</strong> w.r.t. \(c_t\) ensures that the solution \(c_t^*\) is not a synonym of the query concept \(c_e\), while <strong>maximizing the objective \(L_2\)</strong> w.r.t. \(c_t\) finds a sensitive concept to the change of the model‚Äôs parameter \(\theta \rightarrow \theta^{'}\).</p>

<p>This helps identify the most related concept to the query concept \(c_e\), as suggested by the locality property of the concept graph. By maximizing both \(L_1\) and \(L_2\) w.r.t. \(c_t\), we ensure that the solution \(c_t^*\) satisfies both key properties of the ideal target concept.</p>

<h3 id="comparison-with-adversarial-preservation">Comparison with Adversarial Preservation</h3>

<p>The definition of <strong>adversarial concepts</strong>- those most affected by changes in model parameters when a concept is erased- was first introduced in our previous work ‚Äú<a href="https://arxiv.org/abs/2410.15618" rel="external nofollow noopener" target="_blank">Erasing Undesirable Concepts in Diffusion Models with Adversarial Preservation</a>‚Äù.</p>

<p>Building on empirical observations that erasing different concepts impacts the remaining ones in various ways and that preserving a neutral concept alone is insufficient to maintain the model‚Äôs capabilities, we propose a method for preserving sensitive concepts while erasing undesirable ones.
This approach is similar to the adversarial training principle which has been successfully applied to improve the robustness of models against adversarial attacks.</p>

<p>Our ICLR 2025 paper is inspired by the idea of adversarial concepts but with several key differences:</p>

<ul>
  <li>Instead of focusing on the to-be-preserved concept, we investigate the impact of the target concept on the remaining concepts, offering new insights into the selection and importance of the target concept in the erasure problem.</li>
  <li>We propose an improved optimization method that more accurately identifies adversarial concepts, explicitly excluding those identical to the to-be-erased concept‚Äîan aspect not considered in our NeurIPS 2024 paper.</li>
  <li>For the first time, we introduce the concept of a \textit{concept graph} and its properties, providing a deeper understanding of concept relationships in the latent space.</li>
</ul>

<h2 id="experiments">Experiments</h2>

<p>We conducted comprehensive experiments on three erasure tasks to demonstrate the effectiveness of our method. Please refer to the paper for more details.</p>

<p>Beside the experiments that support the superiority of our method (of course as all other papers :D), in this blog post (with more relaxed style), we would like to emphasize some interesting observations that has been discussed in Appendix D of our paper that we think are worthy of future research.</p>

<h3 id="abnormal-concepts">Abnormal Concepts</h3>

<p>One interesting observation is that there are some special concepts that are sensitive to the erasure of any concept, such as ‚ÄúBell Cote‚Äù and ‚ÄúOboe‚Äù. We call them <strong>abnormal concepts</strong>.
It is interesting to see that the abnormal concepts are always the ones that already have low generation capability to begin with, i.e., the lowest DS-5 score (red + blue bar) in the bar chart of the figure below.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/fantastic_concepts/merge_two_stacked_target_empty_English_Springer_19_True-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/fantastic_concepts/merge_two_stacked_target_empty_English_Springer_19_True-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/fantastic_concepts/merge_two_stacked_target_empty_English_Springer_19_True-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/fantastic_concepts/merge_two_stacked_target_empty_English_Springer_19_True.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    Analysis of the impact of choosing empty concept as the target concept for erasure. The concept "Bell Cote" and "Oboe" are the ones that have the lowest DS-5 score (red + blue bar) in the bar chart.
</div>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/fantastic_concepts/netfive_100_0-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/fantastic_concepts/netfive_100_0-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/fantastic_concepts/netfive_100_0-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/fantastic_concepts/netfive_100_0.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/fantastic_concepts/netfive_100_2-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/fantastic_concepts/netfive_100_2-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/fantastic_concepts/netfive_100_2-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/fantastic_concepts/netfive_100_2.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    Failed sample from the "Oboe" concept as showing a man instead of an oboe. The "Bell Cote" generated image is also very hard to recognize as a "bell cote".
</div>

<h3 id="mixture-of-concepts">Mixture of Concepts</h3>

<h4 id="why-mixture-of-concepts">Why mixture of concepts?</h4>

<p>Given that the concept space \(\mathcal{C}\) is discrete and finite, a natural approach to solving Equation 3 would be to enumerate all the concepts in \(\mathcal{C}\) and select the most sensitive concept \(c_t\) that maximizes the total loss at each optimization step of the outer minimization problem. However, this method is computationally impractical due to the large number of concepts in \(\mathcal{C}\). Moreover, many concepts are inherently complex, often composed of multiple attributes, and cannot always be interpreted as singular, isolated concepts within the space \(\mathcal{C}\).</p>

<p>Since the concepts are represented textually and the output of Latent Diffusion Models is controlled by textual prompts, the most intuitive way to create a mixture of concepts, such as combining \(c_1\) and \(c_2\), is through a textual template. For example, using a prompt like ‚Äúa photo of a {$c_1$} and a {$c_2$}‚Äù ensures that both concepts appear in the generated image. However, this approach has a significant limitation: it does not provide gradients, preventing us from using standard backpropagation to learn and fine-tune the target concept \(c_t\).</p>

<p>To address this issue, we employ the Gumbel-Softmax operator to approximate a mixture of concepts. We set the temperature to a value below 1, ensuring that the resulting target concept is a combination of a few dominant concepts, rather than an indiscriminate mixture of all the concepts in \(\mathcal{C}\).</p>

<h4 id="visualization">Visualization</h4>

<p>To illustrate the effect of concept mixtures as described in Equation 4, we visualize the generated images \(g(z_T, (1 - \alpha) \tau(c_1) + \alpha \tau(c_2))\) in Figure below, where \(g()\) represents the image generation function (the diffusion backward process), \(z_T\) is the initial noise input, and \(\tau\) is the textual encoder. We fix \(c_1\) as ‚ÄúEnglish Springer‚Äù and vary \(\alpha\) from 0 to 1 with different \(c_2\) values to simulate the mixture of concepts \(G(\pi) \cdot \mathcal{C}\) in Equation 3. Intuitively, we expect the generated images to gradually transition from concept \(c_1\) to concept \(c_2\) as \(\alpha\) increases.</p>

<p>In cases like ‚ÄúChurch,‚Äù ‚ÄúFrench Horn,‚Äù and ‚ÄúGarbage Truck,‚Äù this gradual transformation is indeed observable, where the image transitions smoothly from ‚ÄúEnglish Springer‚Äù to the target concept as \(\alpha\) increases. However, for other concepts like ‚ÄúBorder Collie‚Äù and ‚ÄúGolf Ball,‚Äù the transformation is less smooth. For instance, the image shifts abruptly from ‚ÄúEnglish Springer‚Äù to ‚ÄúBorder Collie‚Äù when \(\alpha\) increases from 0.4 to 0.5, or from ‚ÄúEnglish Springer‚Äù to ‚ÄúGolf Ball‚Äù as \(\alpha\) changes from 0.4 to 0.7.</p>

<p>This phenomenon suggests that mixing concepts is not merely a linear interpolation between two target concepts, but is influenced by the intrinsic nature of the concepts \(c_1\) and \(c_2\).</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/fantastic_concepts/eval_mixed_images_grid-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/fantastic_concepts/eval_mixed_images_grid-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/fantastic_concepts/eval_mixed_images_grid-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/fantastic_concepts/eval_mixed_images_grid.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    Visualization of the output images $g(z_0, (1 - \alpha) \tau(c_1) + \alpha \tau(c_2))$ with different $\alpha$ and $c_2$.
</div>

<h2 id="citation">Citation</h2>

<p>If you find this work useful in your research, please consider citing our paper (or our other papers <img class="emoji" title=":grin:" alt=":grin:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f601.png" height="20" width="20">):</p>

<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">@article</span><span class="p">{</span><span class="nl">bui2024erasing</span><span class="p">,</span>
  <span class="na">title</span><span class="p">=</span><span class="s">{Erasing Undesirable Concepts in Diffusion Models with Adversarial Preservation}</span><span class="p">,</span>
  <span class="na">author</span><span class="p">=</span><span class="s">{Bui, Anh and Vuong, Long and Doan, Khanh and Le, Trung and Montague, Paul and Abraham, Tamas and Phung, Dinh}</span><span class="p">,</span>
  <span class="na">booktitle</span><span class="p">=</span><span class="s">{NeurIPS}</span><span class="p">,</span>
  <span class="na">year</span><span class="p">=</span><span class="s">{2024}</span>
<span class="p">}</span>

<span class="nc">@article</span><span class="p">{</span><span class="nl">bui2025fantastic</span><span class="p">,</span>
  <span class="na">title</span><span class="p">=</span><span class="s">{Fantastic Targets for Concept Erasure in Diffusion Models and Where to Find Them}</span><span class="p">,</span>
  <span class="na">author</span><span class="p">=</span><span class="s">{Bui, Anh and Vu, Thuy-Trang and Vuong, Long and Le, Trung and Montague, Paul and Abraham, Tamas and Kim, Junae and Phung, Dinh}</span><span class="p">,</span>
  <span class="na">journal</span><span class="p">=</span><span class="s">{ICLR}</span><span class="p">,</span>
  <span class="na">year</span><span class="p">=</span><span class="s">{2025}</span>
<span class="p">}</span>

<span class="nc">@article</span><span class="p">{</span><span class="nl">bui2024removing</span><span class="p">,</span>
  <span class="na">title</span><span class="p">=</span><span class="s">{Hiding and Recovering Knowledge in Text-to-Image Diffusion Models via Learnable Prompts}</span><span class="p">,</span>
  <span class="na">author</span><span class="p">=</span><span class="s">{Bui, Anh and Doan, Khanh and Le, Trung and Montague, Paul and Abraham, Tamas and Phung, Dinh}</span><span class="p">,</span>
  <span class="na">journal</span><span class="p">=</span><span class="s">{Preprint}</span><span class="p">,</span>
  <span class="na">year</span><span class="p">=</span><span class="s">{2024}</span>
<span class="p">}</span>
</code></pre></div></div>

          </article>
</div>

      
    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        ¬© Copyright 2025 Tuan-Anh  Bui. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script>

  <!-- Bootstrap Table -->
  <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script>

  <!-- Load Common JS -->
  <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script>
  <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script>
  <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7KGSMMS9MS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ window.dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-7KGSMMS9MS');
  </script>
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

    
  </body>
</html>
