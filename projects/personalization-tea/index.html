<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mitigating Semantic Collapsing Problem in Generative Personalization with Test-time Embedding Adjustment | Tuan-Anh  Bui</title>
    <meta name="author" content="Tuan-Anh  Bui">
    <meta name="description" content="Researcher in Generative AI and Trustworthy AI
">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Bootstrap Table -->
    <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e">
    <link rel="canonical" href="https://tuananhbui89.github.io/projects/personalization-tea/">

    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">
    <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script>
    <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Tuan-Anh </span>Bui</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/repositories/">repositories</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/teaching/"></a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      
        <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">Mitigating Semantic Collapsing Problem in Generative Personalization with Test-time Embedding Adjustment</h1>
            <p class="post-description"></p>
          </header>

          <article>
            <div style="text-align: center;">
Tuan-Anh Bui<sup>1</sup>, Trang Vu<sup>1</sup>, Trung Le<sup>1</sup>, Junae Kim<sup>2</sup>, Tamas Abraham<sup>2</sup>, Rollin Omari<sup>2</sup>, Amar Kaur<sup>2</sup>, Dinh Phung

<sup>1</sup> Monash University, Australia;
<sup>2</sup> Defence Science and Technology Group, Australia

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <a href="https://github.com/tuananhbui89/Embedding-Adjustment" class="btn btn-primary" target="_blank" rel="external nofollow noopener">GitHub</a>
        <a href="https://arxiv.org/abs/2506.22685" class="btn btn-secondary" target="_blank" rel="external nofollow noopener">arXiv</a>
    </div>
</div>
</div>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
  <li><a href="#table-of-contents">Table of Contents</a></li>
  <li><a href="#abstract">Abstract</a></li>
  <li><a href="#motivation">Motivation</a></li>
  <li><a href="#contributions">Contributions</a></li>
  <li><a href="#semantic-collapsing-problem-witch-hunting">Semantic Collapsing Problem (Witch Hunting)</a></li>
  <li>
<a href="#test-time-embedding-adjustment">Test-Time Embedding Adjustment</a>
    <ul>
      <li><a href="#embedding-adjustment">Embedding Adjustment</a></li>
    </ul>
  </li>
  <li><a href="#surprising-impact-of-tea-on-anti-dreambooth">Surprising Impact of TEA on Anti-DreamBooth</a></li>
  <li><a href="#experiments">Experiments</a></li>
  <li><a href="#citation">Citation</a></li>
  <li><a href="#references">References</a></li>
</ul>

<h2 id="abstract">Abstract</h2>

<p>In this paper, we investigate the semantic collapsing problem in generative personalization, an under-explored topic where the learned visual concept (\(V^*\)) gradually shifts from its original textual meaning and comes to dominate other concepts in multi-concept input prompts. This issue not only reduces the semantic richness of complex input prompts like “a photo of \(V^*\) wearing glasses and playing guitar” into simpler, less contextually rich forms such as “a photo of \(V^*\)” but also leads to simplified output images that fail to capture the intended concept. We identify the root cause as unconstrained optimisation, which allows the learned embedding \(V^*\) to drift arbitrarily in the embedding space, both in direction and magnitude. To address this, we propose a simple yet effective training-free method that adjusts the magnitude and direction of pre-trained embedding at inference time, effectively mitigating the semantic collapsing problem. Our method is broadly applicable across different personalization methods and demonstrates significant improvements in text-image alignment in diverse use cases. Our code is published at <a href="https://github.com/tuananhbui89/Embedding-Adjustment" rel="external nofollow noopener" target="_blank">https://github.com/tuananhbui89/Embedding-Adjustment</a>.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/images/main_5-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/images/main_5-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/images/main_5-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/images/main_5.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>

<div class="caption text-center">
    Our Test-time Embedding Adjustment (TEA) method consistently enhances text-image alignment across diverse personalization approaches (Textual Inversion, DreamBooth, and their variants) and architectures (Stable Diffusion, Flux). Notably, TEA also counteracts the anti-personalization effect of Anti-DreamBooth and restores the protected concept.
</div>

<h2 id="motivation">Motivation</h2>

<p><strong>Misalignment between the input prompt and the generated output</strong> is a grand challenge in generative personalization. 
While the goal is to faithfully preserve the personalized concept and simultaneously respect the semantic content of the prompt, existing methods often fail to achieve this balance. For instance, DreamBooth [1] introduces a class-specific prior preservation loss to mitigate overfitting, while other approaches seek to disentangle the personalized concept from co-occurring or background elements in the reference set [6, 7]. Recent works further attempt to regulate semantic fidelity through regularization strategies [4, 5] or compositional disentanglement [2, 3].</p>

<h2 id="contributions">Contributions</h2>

<p>In this paper, we make three contributions that I personally really proud of:</p>

<ul>
  <li>We first highlight the <strong>semantic collapsing problem</strong> in generative personalization, which is under-explored in the literature. We show that this phenomenon is driven by the <strong>unconstrained optimization</strong> during finetuning of personalization. To be best of our knowledge, this is the first work that explicitly points out this problem.</li>
  <li>We propose a <strong>training-free</strong> method that adjusts the embedding of the personalized concept at inference time, effectively mitigating the semantic collapsing problem. This is a simple, general, and yet very effective approach, and first of its kind :D.</li>
  <li>We make a connection between SCP and Anti-DreamBooth, showing why Anti-DreamBooth works and how TEA can be applied to partially reverse the Anti-DreamBooth effect and restore the protected concept. While several works have shown the weak security of Anti-Personalization frameworks, but most of them focus on the preprocessing phase (i.e., removing the invisible mask in the data, therefore, these data still can be personalized), our work is the first to show the vulnerability of Anti-Personalization frameworks in post-processing phase (i.e., given a thought-to-be-protected model, we can still recover the protected concept).</li>
</ul>

<h2 id="semantic-collapsing-problem-witch-hunting">Semantic Collapsing Problem (Witch Hunting)</h2>

<p>The flow of the paper is a bit odd, that is, I start by hypothesizing the problem, then propose method to show its existence, and finally propose the solution (TEA). While my colleagues argued with me with that flow (problem, solution, explain), I decided to keep it like that (problem, explain, solution) because I believe that when everyone knows the problem, the solution is very straight-forward.</p>

<p>In this section, we present empirical evidence supporting the existence of the semantic collapsing problem and its impact on generation quality. Our key findings are as follows:</p>

<p><strong><em>#1. Existence of SCP.</em></strong> SCP exists in the textual domain, where the prompt \(\lfloor p, V^* \rfloor\) is dominated by the learned embedding \(V^*\) and the semantic meaning of the entire prompt gradually collapses to the learned embedding \(V^*\), i.e., \(\tau(\lfloor p, V^* \rfloor) \rightarrow \tau(V^*)\).</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/celebA_342_ti/prompts/prompt_test_man/dist_average-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/celebA_342_ti/prompts/prompt_test_man/dist_average-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/celebA_342_ti/prompts/prompt_test_man/dist_average-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/celebA_342_ti/prompts/prompt_test_man/dist_average.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/celebA_342_ti/prompts/prompt_test_man/all_distances_dist_average-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/celebA_342_ti/prompts/prompt_test_man/all_distances_dist_average-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/celebA_342_ti/prompts/prompt_test_man/all_distances_dist_average-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/celebA_342_ti/prompts/prompt_test_man/all_distances_dist_average.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption">
    (a/left) The inter-set distance and intra-set distance over the personalization process, and (b) The distance between all possible pairs of sets.
</div>

<p><strong><em>#2. Negative Impact on Generation Quality.</em></strong> SCP leads to the degradation/misalignment in generation quality in the image space, i.e., \(G(\lfloor p, V^* \rfloor) \rightarrow G(V^*)\), particularly for prompts with complex semantic structures.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/clip_alignment_scores/celebA_342_ti/all_settings_prompt_10-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/clip_alignment_scores/celebA_342_ti/all_settings_prompt_10-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/clip_alignment_scores/celebA_342_ti/all_settings_prompt_10-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/clip_alignment_scores/celebA_342_ti/all_settings_prompt_10.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/clip_alignment_scores/celebA_342_db_lora_lr1e-4_rank4_train_text_encoder/all_settings_prompt_10-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/clip_alignment_scores/celebA_342_db_lora_lr1e-4_rank4_train_text_encoder/all_settings_prompt_10-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/clip_alignment_scores/celebA_342_db_lora_lr1e-4_rank4_train_text_encoder/all_settings_prompt_10-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/clip_alignment_scores/celebA_342_db_lora_lr1e-4_rank4_train_text_encoder/all_settings_prompt_10.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption">
    (a/left) The alignment with the ground-truth image and (b) The alignment with the contextual part over the personalization process.
</div>

<p><strong><em>#3. Surprisingly Positive Impact.</em></strong> SCP can also lead to the positive impact on generation quality, particularly for prompts where the concept \(c\) requires a strong visual presence to be recognisable.</p>

<p><strong><em>#4. Root Cause of SCP.</em></strong> SCP arises from unconstrained optimisation during personalization, which leads to arbitrary shifts (both in magnitude and direction) in the embedding of \(V^*\) away from its original semantic concept \(c\).</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/token_norm_distribution_celebA_342_ti-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/token_norm_distribution_celebA_342_ti-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/token_norm_distribution_celebA_342_ti-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/token_norm_distribution_celebA_342_ti.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/token_norm_and_cos_sim_celebA_342_ti-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/token_norm_and_cos_sim_celebA_342_ti-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/token_norm_and_cos_sim_celebA_342_ti-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/token_norm_and_cos_sim_celebA_342_ti.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Left: The distribution of the norm of the token embedding M including special token V, Right: The semantic drift of V in term of magnitude and direction over time.
</div>

<h2 id="test-time-embedding-adjustment">Test-Time Embedding Adjustment</h2>

<p>Given the root cause of SCP, it is naturally rised the question: <strong><em>Can we reverse this semantic shift at test time by adjusting \(V^*\), without modifying the personalization method?</em></strong> Surprisingly, the answer is yes, with a surprisingly simple, general, and yet very effective approach.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/images/illustration_of_tea-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/images/illustration_of_tea-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/images/illustration_of_tea-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/images/illustration_of_tea.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption">
    (left) TEA framework that adjusts the embedding on inference time where both U-Net and text encoder are just personalized pre-trained models. (right) the two stages of TEA: normalization and rotation with SLERP.
</div>

<h3 id="embedding-adjustment">Embedding Adjustment</h3>

<p>Given a pre-trained embedding matrix \(M\) that includes a learned token \(V^*\) (as in Textual Inversion), and a target concept \(c\) toward which we wish to regularise, we propose to adjust \(M_{V^*}\) by aligning both its magnitude and direction with \(M_c\). This is achieved by first normalising the vectors and then applying Spherical Linear Interpolation (SLERP) to interpolate the direction of \(M_{V^*}\) towards \(M_c\), which is effective in high-dimensional vector spaces.</p>

\[\hat{M}_{V^*} = \frac{\sin((1-\alpha)\theta)}{\sin(\theta)} \tilde{M}_{V^*} + \frac{\sin(\alpha\theta)}{\sin(\theta)} \tilde{M}_c\]

<p>Here, \(\theta\) is the angle between the normalized vectors \(\tilde{M}_c\) and \(\tilde{M}_{V^*}\), and \(\alpha \in [0, 1]\) controls the rotation factor, where the bigger \(\alpha\) is, the more the embedding is rotated towards \(M_c\).</p>

<p>The normalisation vectors are defined as:</p>
<ul>
  <li>
\[\tilde{M}_{V^*} = \beta \left\| M_c \right\| \frac{M_{V^*}}{\left\| M_{V^*} \right\|}\]
  </li>
  <li>
\[\tilde{M}_c = \beta \left\| M_c \right\| \frac{M_c}{\left\| M_c \right\|}\]
  </li>
</ul>

<p>where \(\beta\) is the scaling factor to control the magnitude of the embedding relative to the reference concept \(c\).</p>

<p>In Dreambooth-based personalization, because the embedding matrix \(M\) is not updated during the optimisation, we propose to adjust at the prompt level instead of the token level as illustrated in the figure above. More specifically, given a prompt \(\lfloor p, V^* \rfloor\) and a target prompt \(\lfloor p, c \rfloor\), we obtain the two embeddings \(\tau(\lfloor p, V^* \rfloor)\) and \(\tau(\lfloor p, c \rfloor)\) from the text encoder \(\tau_{\phi}\) and then adjust the embedding of \(\lfloor p, V^* \rfloor\) by using the above equation on every token in the prompt.</p>

\[\hat{\tau}(\lfloor p, V^* \rfloor)[i] = \frac{\sin((1-\alpha)\theta_i)}{\sin(\theta_i)} \tilde{\tau}(\lfloor p, V^* \rfloor)[i] + \frac{\sin(\alpha\theta_i)}{\sin(\theta_i)} \tilde{\tau}(\lfloor p, c \rfloor)[i]\]

<p>where \(i\) indexes each token in the prompt, and \(\theta_i\) is the angle between the \(i\)-th token embeddings of the two prompts after normalisation.</p>

<p>This method enables a test-time adjustment of semantic drift without retraining, making it a lightweight and broadly applicable solution to mitigating SCP effects.</p>

<h2 id="surprising-impact-of-tea-on-anti-dreambooth">Surprising Impact of TEA on Anti-DreamBooth</h2>

<p>We hypothesize that the adversarial learning process of Anti-DreamBooth actually amplifies the dominance of the personalized concept \(V^*\), but with good implications for user privacy, 
by causing the prompt embedding \(\lfloor p, V^* \rfloor\) to drift even further from its original concept \(\lfloor p, c \rfloor\), resulting to distorted generations of the protected concept \(V^*\).</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/images/tea/db_lora_semantic_drift_gen_prompt_actions-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/images/tea/db_lora_semantic_drift_gen_prompt_actions-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/images/tea/db_lora_semantic_drift_gen_prompt_actions-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/images/tea/db_lora_semantic_drift_gen_prompt_actions.png" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Semantic drift analysis of DreamBooth trained with Anti-DreamBooth adversarial masks.
</div>

<p>Surprisingly, when we apply TEA to DreamBooth models poisoned by Anti-DreamBooth, we observe a mitigation effect such that 
the generated images by TEA are less distorted and more aligned with the to-be-protected concept \(V^*\) as shown in Figure below. 
This surprising result reveals an intriguing false sense of security of Anti-DreamBooth, such that despite adversarial masking,<br>
the poisoned personalized model still retains traces of the correct/to-be-protected concept \(V^*\), 
which can be recovered partially with our TEA. To the best of our knowledge, this is the first work to uncover such a counter-intuitive vulnerability of Anti-DreamBooth.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/images/tea/n000050_DREAMBOOTH/vary_rho_alpha0.9_specific_ids-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/images/tea/n000050_DREAMBOOTH/vary_rho_alpha0.9_specific_ids-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/images/tea/n000050_DREAMBOOTH/vary_rho_alpha0.9_specific_ids-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/images/tea/n000050_DREAMBOOTH/vary_rho_alpha0.9_specific_ids.jpg" class="img-fluid rounded z-depth-1" width="600" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Effect of applying TEA to models poisoned by Anti-DreamBooth.
    TEA is able to mitigate the corruption and recover less distorted generations of the protected concept, revealing a surprising weakness in Anti-DreamBooth.
</div>

<h2 id="experiments">Experiments</h2>

<p>We demonstrate the effectiveness of TEA on addressing the SCP across six representative and recent personalization methods, two architectures (Stable Diffusion and Flux) and three datasets (CS101, CelebA, and Relationship) consisting of total 22 concepts. Please refer to the paper for more details. I really proud of the results and the simplicity, generalizability, and effectiveness of TEA :D.</p>

<p>Some qualitative results are shown below when our TEA is applied to SOTA personalization methods.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/EasyControl/evaluation_demo/output_cs101_pet_dog_1/prompt_7_grid-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/EasyControl/evaluation_demo/output_cs101_pet_dog_1/prompt_7_grid-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/EasyControl/evaluation_demo/output_cs101_pet_dog_1/prompt_7_grid-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/EasyControl/evaluation_demo/output_cs101_pet_dog_1/prompt_7_grid.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    <strong>Output from EasyControl</strong>
</div>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/EasyControl/evaluation_demo/output_cs101_pet_dog_1_tea/prompt_7_grid-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/EasyControl/evaluation_demo/output_cs101_pet_dog_1_tea/prompt_7_grid-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/EasyControl/evaluation_demo/output_cs101_pet_dog_1_tea/prompt_7_grid-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/EasyControl/evaluation_demo/output_cs101_pet_dog_1_tea/prompt_7_grid.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    <strong>Output from EasyControl with TEA</strong>
</div>

<div class="caption">
    Comparison of the output from EasyControl pipeline with and without TEA with the same prompt: 'V dog in a construction outfit' and same random seed. EasyControl with TEA significantly improves the prompt fidelity, mitigating the failure cases of the original EasyControl pipeline, such as the dog stands beside a person or holding a gun. More results showing the same improvement of EasyControl with TEA can be found at <a href="https://github.com/tuananhbui89/Embedding-Adjustment" target="_blank" rel="external nofollow noopener">https://github.com/tuananhbui89/Embedding-Adjustment</a>.
</div>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/ReVersion/evaluation_massive/carved_by/cat_R_carrot_in_the_garden-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/ReVersion/evaluation_massive/carved_by/cat_R_carrot_in_the_garden-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/ReVersion/evaluation_massive/carved_by/cat_R_carrot_in_the_garden-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/ReVersion/evaluation_massive/carved_by/cat_R_carrot_in_the_garden.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    <strong>Output from ReVersion</strong>
</div>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/ReVersion/evaluation_massive/carved_by_tea/cat_R_carrot_in_the_garden-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/ReVersion/evaluation_massive/carved_by_tea/cat_R_carrot_in_the_garden-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/ReVersion/evaluation_massive/carved_by_tea/cat_R_carrot_in_the_garden-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/ReVersion/evaluation_massive/carved_by_tea/cat_R_carrot_in_the_garden.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    <strong>Output from ReVersion with TEA</strong>
</div>

<div class="caption">
    Comparison of the output from ReVersion pipeline with and without TEA with the same prompt: 'cat &lt;R&gt; carrot in the garden' and same random seed. ReVersion with TEA significantly improves the prompt fidelity, mitigating the failure cases of the original ReVersion pipeline, such as the cat is not carved by the carrot or only shows the carrot. More results showing the same improvement of ReVersion with TEA can be found at <a href="https://github.com/tuananhbui89/Embedding-Adjustment" target="_blank" rel="external nofollow noopener">https://github.com/tuananhbui89/Embedding-Adjustment</a>.
</div>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/ClassDiffusion/evaluation_demo/barn_cls/prompt_1_grid-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/ClassDiffusion/evaluation_demo/barn_cls/prompt_1_grid-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/ClassDiffusion/evaluation_demo/barn_cls/prompt_1_grid-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/ClassDiffusion/evaluation_demo/barn_cls/prompt_1_grid.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    <strong>Output from ClassDiffusion</strong>
</div>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-personalization-tea/results/ClassDiffusion/evaluation_demo/barn_cls_tea_rho_0.2_alpha_0.5/prompt_1_grid-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-personalization-tea/results/ClassDiffusion/evaluation_demo/barn_cls_tea_rho_0.2_alpha_0.5/prompt_1_grid-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-personalization-tea/results/ClassDiffusion/evaluation_demo/barn_cls_tea_rho_0.2_alpha_0.5/prompt_1_grid-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/2025-personalization-tea/results/ClassDiffusion/evaluation_demo/barn_cls_tea_rho_0.2_alpha_0.5/prompt_1_grid.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

</figure>

    </div>
</div>
<div class="caption text-center">
    <strong>Output from ClassDiffusion with TEA</strong>
</div>

<div class="caption">
    Comparison of the output from ClassDiffusion pipeline with and without TEA with the same prompt: 'barn' and same random seed. ClassDiffusion with TEA significantly improves the prompt fidelity, mitigating the failure cases of the original ClassDiffusion pipeline, such as the image does not contain a barn but only a sunflower field. More results showing the same improvement of ClassDiffusion with TEA can be found at <a href="https://github.com/tuananhbui89/Embedding-Adjustment" target="_blank" rel="external nofollow noopener">https://github.com/tuananhbui89/Embedding-Adjustment</a>.
</div>

<h2 id="citation">Citation</h2>

<p>If you find this work useful in your research, please consider citing our paper</p>

<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">@article</span><span class="p">{</span><span class="nl">bui2025mitigating</span><span class="p">,</span>
  <span class="na">title</span><span class="p">=</span><span class="s">{Mitigating Semantic Collapse in Generative Personalization with a Surprisingly Simple Test-Time Embedding Adjustment}</span><span class="p">,</span>
  <span class="na">author</span><span class="p">=</span><span class="s">{Bui, Anh and Vu, Trang and Le, Trung and Kim, Junae and Abraham, Tamas and Omari, Rollin and Kaur, Amar and Phung, Dinh}</span><span class="p">,</span>
  <span class="na">journal</span><span class="p">=</span><span class="s">{arXiv preprint arXiv:2506.22685}</span><span class="p">,</span>
  <span class="na">year</span><span class="p">=</span><span class="s">{2025}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="references">References</h2>

<p>[1] Ruiz, Nataniel, et al. “Dreambooth: Fine tuning text-to-image diffusion models for subject-driven generation.” Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. 2023.</p>

<p>[2] Motamed, Saman, Danda Pani Paudel, and Luc Van Gool. “Lego: Learning to Disentangle and Invert Personalized Concepts Beyond Object Appearance in Text-to-Image Diffusion Models.” arXiv preprint arXiv:2311.13833 (2023).</p>

<p>[3] Huang, Jiannan, et al. “Classdiffusion: More aligned personalization tuning with explicit class guidance.” arXiv preprint arXiv:2405.17532 (2024).</p>

<p>[4] Han, Ligong, et al. “Svdiff: Compact parameter space for diffusion fine-tuning.” Proceedings of the IEEE/CVF International Conference on Computer Vision. 2023.</p>

<p>[5] Qiu, Zeju, et al. “Controlling text-to-image diffusion by orthogonal finetuning.” Advances in Neural Information Processing Systems 36 (2023): 79320-79362.</p>

<p>[6] Avrahami, Omri, et al. “Break-a-scene: Extracting multiple concepts from a single image.” SIGGRAPH Asia 2023 Conference Papers. 2023.</p>

<p>[7] Jin, Chen, et al. “An image is worth multiple words: Discovering object level concepts using multi-concept prompt learning.” Forty-first International Conference on Machine Learning. 2024.</p>

<!-- mkdir -p assets/img/2025-personalization-tea/ -->
<!-- mv _posts/2025-09-30-*.png assets/img/2025-personalization-tea/ -->

          </article>
</div>

      
    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2025 Tuan-Anh  Bui. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script>

  <!-- Bootstrap Table -->
  <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script>

  <!-- Load Common JS -->
  <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script>
  <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script>
  <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7KGSMMS9MS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ window.dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-7KGSMMS9MS');
  </script>
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

    
  </body>
</html>
